(function(n,t){"use strict";var f=t.module("ngDialog",[]),i=t.element,r=t.isDefined,u=(document.body||document.documentElement).style,s=r(u.animation)||r(u.WebkitAnimation)||r(u.MozAnimation)||r(u.MsAnimation)||r(u.OAnimation),e="animationend webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend",o=!1;f.provider("ngDialog",function(){var c=this.defaults={className:"ngdialog-theme-default",plain:!1,showClose:!0,closeByDocument:!0,closeByEscape:!0,closeByNavigation:!1,appendTo:!1,preCloseCallback:!1,overlay:!0,cache:!0};this.setForceBodyReload=function(n){o=n||!1};this.setDefaults=function(n){t.extend(c,n)};var u=0,r=0,f,h={};this.$get=["$document","$templateCache","$compile","$q","$http","$rootScope","$timeout","$window","$controller",function(l,a,v,y,p,w,b,k,d){var g=l.find("body"),nt,tt;return o&&w.$on("$locationChangeSuccess",function(){g=l.find("body")}),nt={onDocumentKeydown:function(n){n.keyCode===27&&tt.close("$escape")},setBodyPadding:function(n){var t=parseInt(g.css("padding-right")||0,10);g.css("padding-right",t+n+"px");g.data("ng-dialog-original-padding",t)},resetBodyPadding:function(){var n=g.data("ng-dialog-original-padding");n?g.css("padding-right",n+"px"):g.css("padding-right","")},performCloseDialog:function(i,u){var o=i.attr("id"),c;typeof n.Hammer!="undefined"?(c=t.element(i).scope().hammerTime,c.off("tap",f),c.destroy(),delete i.scope().hammerTime):i.unbind("click");r===1&&g.unbind("keydown");i.hasClass("ngdialog-closing")||(r-=1);w.$broadcast("ngDialog.closing",i);s?i.unbind(e).bind(e,function(){i.scope().$destroy();i.remove();r===0&&(g.removeClass("ngdialog-open"),nt.resetBodyPadding());w.$broadcast("ngDialog.closed",i)}).addClass("ngdialog-closing"):(i.scope().$destroy(),i.remove(),r===0&&(g.removeClass("ngdialog-open"),nt.resetBodyPadding()),w.$broadcast("ngDialog.closed",i));h[o]&&(h[o].resolve({id:o,value:u,$dialog:i,remainingDialogs:r}),delete h[o])},closeDialog:function(n,i){var u=n.data("$ngDialogPreCloseCallback"),r;u&&t.isFunction(u)?(r=u.call(n,i),t.isObject(r)?r.closePromise?r.closePromise.then(function(){nt.performCloseDialog(n,i)}):r.then(function(){nt.performCloseDialog(n,i)},function(){return}):r!==!1&&nt.performCloseDialog(n,i)):nt.performCloseDialog(n,i)}},tt={open:function(e){function ft(n,t){return p.get(n,t||{}).then(function(n){return n.data||""})}function et(n){return n?t.isString(n)&&o.plain?n:typeof o.cache=="boolean"&&!o.cache?ft(n,{cache:!1}):a.get(n)||ft(n,{cache:!0}):"Empty template"}var it=this,o=t.copy(c),ut,l,s,rt;return e=e||{},t.extend(o,e),u+=1,it.latestID="ngdialog"+u,h[it.latestID]=ut=y.defer(),l=t.isObject(o.scope)?o.scope.$new():w.$new(),y.when(et(o.template||o.templateUrl)).then(function(e){var c,y,p,h,ut;if(a.put(o.template||o.templateUrl,e),o.showClose&&(e+='<div class="ngdialog-close"><\/div>'),it.$result=s=i('<div id="ngdialog'+u+'" class="ngdialog"><\/div>'),s.html(o.overlay?'<div class="ngdialog-overlay"><\/div><div class="ngdialog-content">'+e+"<\/div>":'<div class="ngdialog-content">'+e+"<\/div>"),o.data&&t.isString(o.data)?(c=o.data.replace(/^\s*/,"")[0],l.ngDialogData=c==="{"||c==="["?t.fromJson(o.data):o.data):o.data&&t.isObject(o.data)&&(l.ngDialogData=t.fromJson(t.toJson(o.data))),o.controller&&(t.isString(o.controller)||t.isArray(o.controller)||t.isFunction(o.controller))&&(y={$scope:l,$element:s},t.extend(y,o.locals),p=d(o.controller,y),s.data("$ngDialogControllerController",p)),o.className&&s.addClass(o.className),rt=o.appendTo&&t.isString(o.appendTo)?t.element(document.querySelector(o.appendTo)):g,o.preCloseCallback&&(t.isFunction(o.preCloseCallback)?h=o.preCloseCallback:t.isString(o.preCloseCallback)&&l&&(t.isFunction(l[o.preCloseCallback])?h=l[o.preCloseCallback]:l.$parent&&t.isFunction(l.$parent[o.preCloseCallback])?h=l.$parent[o.preCloseCallback]:w&&t.isFunction(w[o.preCloseCallback])&&(h=w[o.preCloseCallback])),h&&s.data("$ngDialogPreCloseCallback",h)),l.closeThisDialog=function(n){nt.closeDialog(s,n)},b(function(){var t,n;v(s)(l);t=k.innerWidth-g.prop("clientWidth");g.addClass("ngdialog-open");n=t-(k.innerWidth-g.prop("clientWidth"));n>0&&nt.setBodyPadding(n);rt.append(s);o.name?w.$broadcast("ngDialog.opened",{dialog:s,name:o.name}):w.$broadcast("ngDialog.opened",s)}),o.closeByEscape&&g.bind("keydown",nt.onDocumentKeydown),o.closeByNavigation&&w.$on("$locationChangeSuccess",function(){nt.closeDialog(s)}),f=function(n){var r=o.closeByDocument?i(n.target).hasClass("ngdialog-overlay"):!1,t=i(n.target).hasClass("ngdialog-close");(r||t)&&tt.close(s.attr("id"),t?"$closeButton":"$document")},typeof n.Hammer!="undefined"){ut=l.hammerTime=n.Hammer(s[0]);ut.on("tap",f)}else s.bind("click",f);return r+=1,tt}),{id:"ngdialog"+u,closePromise:ut.promise,close:function(n){nt.closeDialog(s,n)}}},openConfirm:function(n){var u=y.defer(),r={closeByEscape:!1,closeByDocument:!1},f;return t.extend(r,n),r.scope=t.isObject(r.scope)?r.scope.$new():w.$new(),r.scope.confirm=function(n){u.resolve(n);var t=i(document.getElementById(f.id));nt.performCloseDialog(t,n)},f=tt.open(r),f.closePromise.then(function(n){return n?u.reject(n.value):u.reject()}),u.promise},close:function(n,t){var r=i(document.getElementById(n));return r.length?nt.closeDialog(r,t):tt.closeAll(t),tt},closeAll:function(n){var r=document.querySelectorAll(".ngdialog");t.forEach(r,function(t){nt.closeDialog(i(t),n)})},getDefaults:function(){return c}},tt}]});f.directive("ngDialog",["ngDialog",function(n){return{restrict:"A",scope:{ngDialogScope:"="},link:function(i,r,u){r.on("click",function(r){var e,f;r.preventDefault();e=t.isDefined(i.ngDialogScope)?i.ngDialogScope:"noScope";t.isDefined(u.ngDialogClosePrevious)&&n.close(u.ngDialogClosePrevious);f=n.getDefaults();n.open({template:u.ngDialog,className:u.ngDialogClass||f.className,controller:u.ngDialogController,scope:e,data:u.ngDialogData,showClose:u.ngDialogShowClose==="false"?!1:u.ngDialogShowClose==="true"?!0:f.showClose,closeByDocument:u.ngDialogCloseByDocument==="false"?!1:u.ngDialogCloseByDocument==="true"?!0:f.closeByDocument,closeByEscape:u.ngDialogCloseByEscape==="false"?!1:u.ngDialogCloseByEscape==="true"?!0:f.closeByEscape,preCloseCallback:u.ngDialogPreCloseCallback||f.preCloseCallback})})}}}])})(window,window.angular);